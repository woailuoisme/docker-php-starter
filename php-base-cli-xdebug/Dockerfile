# ============================================================================
# Xdebug 调试工具
# ============================================================================
FROM jiaoio/php-base-cli
LABEL maintainer="seaside <531773730@qq.com>"

ARG WITH_XDEBUG=true

# ============================================================================
# Xdebug 安装和配置
# ============================================================================
COPY --from=mlocati/php-extension-installer /usr/bin/install-php-extensions /usr/local/bin/

RUN set -eux; \
    if [ "$WITH_XDEBUG" = "true" ]; then \
    install-php-extensions xdebug-^3@stable spx; \
    fi

# ============================================================================
# Xdebug 配置文件复制
# ============================================================================

COPY xdebug.ini /usr/local/etc/php/conf.d/99-xdebug.ini

# ============================================================================
# 工作目录设置
# ============================================================================

WORKDIR /var/www

EXPOSE 9001 9003
